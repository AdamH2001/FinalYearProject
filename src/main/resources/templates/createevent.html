<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" ></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.11.8/umd/popper.min.js"> </script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"></script>
	<link rel="stylesheet" href="./css/styles.css"/>
	<script src="./scripts/afterschoolclub.js"></script>	


</head>
<body onLoad="setDateLimits()">
	<div th:replace="~{fragments/header :: header}"></div>
	<div class="container-fluid">
		<div class="row flex-nowrap">
			<div th:replace="~{fragments/leftnav :: leftnav}"
				class="col-auto col-md-3 col-xl-2 px-sm-2 px-0 bg-dark"></div>

			<div class="container-fluid col-sm-10">


			<form action="./addEvent" method="post" onSubmit="validateEventForm(event)">
				<input id="eventId" type="hidden" name="eventId" th:value="${clubSession.getEventId()}" />
				
							
				<div class="col py-3">

					<div class="row mb-2">
						<div class="col-sm-8" align="center">
							<h1 th:if="${editing}" align="center">Edit Club Session</h1>
							<h1 th:unless="${editing}" align="center">Schedule Club Session</h1>
						</div>
					</div>
					<th:block th:if="${resourceStatus}">
						<th:block  th:each="status : ${resourceStatus}" >
							<div th:unless="${status.isSufficient()}" class="afterschoolclubflash row mb-2">
								<div class="col-sm-8" th:text="${status.getMessage()}">FlashMessage</div>
							</div>						
						</th:block>
					</th:block>
					
					<div class="afterschoolclubflash row mb-2"  style="display:none" id="validationContainer">					
						<div class="col-sm-8"  id="validationMessage"></div>
					</div>	

					<div class="row mb-2">
						<div class="col-sm-2" align="center">
							<label for="club">Club:</label>
						</div>
						<div class="col-sm-2">
							<select class="form-select form-control-sm mr-sm-2"  name="club" id="club" required th:disabled="${clubSession.getNumberAttendees()>0}">
								<option th:each="club : ${clubs}" th:value="${club.getClubId()}" th:text="${club.getTitle()}" th:selected="${clubSession.getClub()?.getClubId() == club.getClubId()}">Club Title</option>
							</select>
						</div>
					</div>

					<div class="row mb-2">
						<div class="col-sm-2" align="center">
							<label for="club">Location:</label>
						</div>
						<div class="col-sm-2">
							<select class="form-select form-control-sm mr-sm-2" name="location" id="location" required>
								<option th:each="location : ${locations}" 
										th:value="${location.getResourceId()}" 
										th:text="${location.getName()}" 
										th:selected="${clubSession.getLocation()?.getResourceId() == location.getResourceId()}">location Name</option>
							</select>
						</div>
						<div class="col-sm-2" align="center">
							<label for="maxAttendees">Max Attendees:</label>
						</div>
						<div class="col-sm-2">
							<input class="form-control form-control-sm mr-sm-2" required type="number" name="maxAttendees" id="maxAttendees" th:value="${clubSession.getMaxAttendees()}" />
						</div>
						
					</div>
					
					<div class="row mb-2">
						<div class="col-sm-2" align="center" >
							<label for="staff">Staff:</label>
						</div>
						<div class="col-sm-6">
							<select class="form-select form-control-sm mr-sm-2" name="staff" id="staff" required multiple>
								<option th:each="staffMember : ${staff}" th:value="${staffMember.getResourceId()}" th:text="${staffMember.getName()}" th:selected="${clubSession.requiresStaff(staffMember)}">Staff Name</option>
							</select>
						</div>
					</div>
										
					
					<div class="row mb-2">
						<div class="col-sm-2" align="center">
							<label for="startDate">Start Date:</label>
						</div>
						<div class="col-sm-2">
							<input class="form-control form-control-sm mr-sm-2" min="" required type="date" name="startDate" id="startDate" th:value="${clubSession.getStartDate()}" onChange="setDateLimits()"/>
						</div>
						<div class="col-sm-2" align="center">
							<label for="startTime">Start Time:</label>
						</div>
						<div class="col-sm-2">
							<input class="form-control form-control-sm mr-sm-2" min="06:00" required type="time" name="startTime" id="startTime"  th:value="${clubSession.getStartTime()}" onChange="setDateLimits()"/>
						</div>						
					</div>
					
					<div class="row mb-2">
						<div class="col-sm-4" align="center">
							&nbsp;
						</div>
						<div class="col-sm-2" align="center">
							<label for="endTime">End Time:</label>
						</div>
						<div class="col-sm-2">
							<input class="form-control form-control-sm mr-sm-2" required type="time" name="endTime" id="endTime" th:value="${clubSession.getEndTime()}" onChange="setDateLimits()"/>
						</div>
					</div>
					
					<div class="row mb-2">
						<div class="col-sm-2" align="center" >
							<label for="staff">Refreshments:</label>
						</div>
						<div class="col-sm-6">
							<select class="form-select form-control-sm mr-sm-2" name="menu" id="menu" multiple>
								<option th:each="menu : ${menus}" th:value="${menu.getMenuGroupId()}" th:text="${menu.getName()}" th:selected="${clubSession.includesMenuGroup(menu.getMenuGroupId())}">Menu Name</option>
							</select>
						</div>
					</div>
					
					<div class="row mb-2">
						<div class="col-sm-2" align="center" >
							<label for="equipment">Equipment</label>
						</div>
						<div class="col-sm-2" align="center" >
							<label for="equipment">Item</label>
						</div>
						
						<div class="col-sm-2" align="center" >
							<label for="equipment">Quantity</label>
						</div>
						<div class="col-sm-2" align="center" >
							<label for="equipment">Per Attendee</label>
						</div>						
					</div>
					
					
					<div th:each="sessionResource, iter: ${clubSession.getEquipmentEventResources()}"  class="row mb-2" th:id="${'item'+(iter.index+1)}">
						<div class="col-sm-2" align="center" >
							<label for="equipment" th:text="${'Item '+(iter.index+1)+ ':'}">Item 1:</label>
						</div>
						<div class="col-sm-2">
							<select class="form-select form-control-sm mr-sm-2"  name="equipment" th:id="${'equipment'+(iter.index+1)}">
								<option value=0 >None</option>
								<option th:each="item : ${equipment}" th:value="${item.getResourceId()}" th:text="${item.getName()}" th:selected="${sessionResource.getResourceId().getId().intValue()==item.getResourceId()}">Equipment Name</option>
							</select>
						</div>

						<div class="col-sm-2">
							<input class="form-control form-control-sm mr-sm-2" th:id="${'equipmentQuantity'+(iter.index+1)}"
								type="number" name="equipmentQuantity"  th:value="${sessionResource.getQuantity()}"/>
						</div>
						<div class="col-sm-2" align="center">
							<input class="form-check-input" type="checkbox" name="perAttendee" th:id="${'perAttendee'+(iter.index+1)}"  th:checked="${sessionResource.isPerAttendee()}"/>
							<input type="hidden" name="hiddenPerAttendee" id="hiddenPerAttendee" />  
		  															
						</div>
						<div class="col-sm-2" th:id="${'item' + (iter.index+1) + 'buttons'}" th:style="${iter.last}?'':'display:none'" >
								<button type="button" th:unless="${iter.index==10}" th:id="${'add' +(iter.index+1)}" class="btn btn-secondary"  onClick="addRow(this)" >+</button>
								<button type="button" th:unless="${iter.first}" th:id="${'remove' +(iter.index+1)}"class="btn btn-secondary" onCLick="removeRow(this)">-</button>																
						</div>
					</div>			
					
					<div th:each="i : ${#numbers.sequence(clubSession.getEquipmentEventResources().size()+1, 10)}"  class="row mb-2" th:id="${'item'+i}" th:style="${i==1} ? '':'display:none'">
						<div class="col-sm-2" align="center" >
							<label for="equipment" th:text="${'Item '+i+ ':'}">Item 1:</label>
						</div>
						<div class="col-sm-2">
							<select class="form-select form-control-sm mr-sm-2"  name="equipment" th:id="${'equipment'+i}">
								<option value=0 >None</option>
								<option th:each="item : ${equipment}" th:value="${item.getResourceId()}" th:text="${item.getName()}">Equipment Name</option>
							</select>
						</div>

						<div class="col-sm-2">
							<input class="form-control form-control-sm mr-sm-2"  th:id="${'equipmentQuantity'+ i}"
								type="number" name="equipmentQuantity" value="0" />
						</div>
						<div class="col-sm-2" align="center">
							<input class="form-check-input" type="checkbox" name="perAttendee" th:id="${'perAttendee'+i}"  />
							<input type="hidden" name="hiddenPerAttendee" id="hiddenPerAttendee" />  
						</div>
						<div class="col-sm-2" th:id="${'item' + i + 'buttons'}"  >
								<button type="button" th:unless="${i==10}" th:id="${'add' + i}" class="btn btn-secondary"  onClick="addRow(this)" >+</button>
								<button type="button" th:unless="${i==1}" th:id="${'remove' + i}"class="btn btn-secondary" onCLick="removeRow(this)">-</button>																
						</div>
					</div>	
												
					<div class="row mb-2">

						<div class="col-sm-4" align="right">
							<button th:if="${editing}" class="btn btn-primary" name="submit" onclick="hiddenPerAttendee[0].value=perAttendee[0].checked; hiddenPerAttendee[1].value=perAttendee[1].checked; hiddenPerAttendee[2].value=perAttendee[2].checked; hiddenPerAttendee[3].value=perAttendee[3].checked; hiddenPerAttendee[4].value=perAttendee[4].checked; ">Update</button>
							<button th:unless="${editing}" class="btn btn-primary" name="submit" onclick="hiddenPerAttendee[0].value=perAttendee[0].checked; hiddenPerAttendee[1].value=perAttendee[1].checked; hiddenPerAttendee[2].value=perAttendee[2].checked; hiddenPerAttendee[3].value=perAttendee[3].checked; hiddenPerAttendee[4].value=perAttendee[4].checked; ">Schedule</button>
						</div>
						<div class="col-sm-4" align="left">
							<a href="./calendar" class="btn btn-secondary" role="button">Cancel</a>
						</div>						
					</div>
				</div>
			</form>
		</div>
		</div>

	</div>
	<div th:replace="~{fragments/footer :: footer}"></div>
</body>
</html>